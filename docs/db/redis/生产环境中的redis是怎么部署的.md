### 面试题
生产环境中的redis是怎么部署的？

### 面试官心理分析
看看你了解不了解你们公司的 redis 生产集群的部署架构，如果你不了解，那么确实你就很失职了，你的 redis 是主从架构？集群架构？用了哪种集群方案？有没有做高可用保证？有没有开启持久化机制确保可以进行数据恢复？线上 redis 给几个 G 的内存？设置了哪些参数？压测后你们 redis 集群承载多少 QPS？

面试题剖析
** redis cluster，20 台机器，10主10从，每个主实例挂了一个从实例，10 个节点对外提供读写服务，每个节点的读写高峰qps可能可以达到每秒 5 万，5 台机器最多是 50 万读写请求/s。

机器是什么配置？16G 内存+ 8核CPU + 1T磁盘，但是分配给redis进程的是4g内存，一般线上生产环境，redis的内存尽量不要超过10g，超过10g可能会有问题。

10台机器对外提供读写，一共有40g内存。
因为每个主实例都挂了一个从实例，所以是高可用的，任何一个主实例宕机，都会自动故障迁移，redis 从实例会自动变成主实例继续提供读写服务。

你往内存里写的是什么数据？每条数据的大小是多少？各种类型的额数据，每条数据是1-2kb。2000条数据是 1mb，1000万条数据是1g。一次操作10次redis,支持8亿次的数据存储，目前仅仅不到总内存的10G左右。目前高峰期每秒就是 3500 左右的请求量。

